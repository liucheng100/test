import{_ as C,E as r,o as p,c as m,d as i,n as v,f as k,B as y,F as N,e as E,a as d,l as _,C as O,u as F,t as w,p as I,i as B}from"./index.b6fd4dc1.js";import{E as x}from"./el-input.62d293a6.js";/* empty css                   */import{u as W,c as b}from"./file.abfe09ac.js";import{n as S}from"./work.7d305944.js";import{c as T}from"./contest.14823739.js";import{i as V}from"./common.eb3c7a8c.js";import"./index.dcc0ffaa.js";const G={name:"submit",emits:[],props:{},inject:["globalData"],data(){return{source:"",xheight:"",loading:!1,artIntro:"",artName:"",ON:!1,formdata:{workTitle:"",description:"",workFile:0,contestGroup:1,contestId:-1},group_cache:0,pop1:!1,pop2:!1,pop3:!1,pop4:!1,pop5:!1,net_event_id:0,isSafari:!0}},computed:{contestgroup(){return this.formdata.contestGroup}},watch:{contestgroup(s){},source(s){s&&this.contestgroup==3&&this.$nextTick(()=>{this.$refs.videoEle.addEventListener("playing",()=>{this.$refs.videoEle.pause(),this.$refs.videoEle.currentTime=0}),this.$refs.videoEle.addEventListener("loadeddata",()=>{this.$refs.videoEle.play()})})}},methods:{TabClick(s){(s==3||this.contestgroup==3)&&(s!=3||this.contestgroup!=3)&&this.formdata.workFile?(this.pop5=!0,this.group_cache=s):this.loading?r.info("\u4E0A\u4F20\u6587\u4EF6\u4E2D"):this.formdata.contestGroup=s},trashFn(){this.formdata.workFile?this.pop3=!0:this.removeWork()},removeWork(){this.pop3=!1,this.source=this.xheight=this.formdata.workFile="",this.loading=!1,this.net_event_id++},upload(){if(this.loading){r.info("\u6587\u4EF6\u4E0A\u4F20\u4E2D");return}if(this.formdata.workFile){this.pop4=!0;return}this.save_the_event_id++;let s=document.createElement("input");s.setAttribute("type","file"),this.formdata.contestGroup==3?s.setAttribute("accept","video/*"):s.setAttribute("accept","image/*"),s.click(),s.onchange=t=>{let g=this.net_event_id,c=t.target.files[0];c=new window.File([c],c.name,{type:c.type});let e=new FormData;e.append("file",c);let l=window.URL.createObjectURL(c);this.source=l,this.loading=!0,W(e).then(n=>{if(g==this.net_event_id)if(console.log(n),n.code)r.error("\u4E0A\u4F20\u5931\u8D25\u8BF7\u91CD\u8BD5");else if(r.success("\u4E0A\u4F20\u6210\u529F"),this.contestgroup!=3){let h=this.$refs.sourceImg.naturalHeight,a=this.$refs.sourceImg.naturalWidth,o=h/a,u=this.$refs.sourceImg.offsetWidth;this.xheight=o*u,this.formdata.workFile=n.data,this.source=b(n.data),this.loading=!1}else this.formdata.workFile=n.data,this.source=b(n.data),this.$refs.videoEle.addEventListener("loadeddata",()=>{let h=this.$refs.videoEle.videoHeight,a=this.$refs.videoEle.videoWidth,o=h/a,u=this.$refs.videoEle.offsetWidth;this.xheight=o*u,setTimeout(()=>{this.loading=!1},1e3)})}).catch(n=>{r.error("\u4E0A\u4F20\u5931\u8D25\u8BF7\u91CD\u8BD5"+n),console.log(n)})}},submit(){if(this.formdata.contestId==-1){r.warning("\u65E0\u6CD5\u6355\u83B7\u8D5B\u4E8Bid,\u8BF7\u5237\u65B0");return}if(!this.formdata.workTitle){r.warning("\u4F5C\u54C1\u540D\u4E0D\u80FD\u4E3A\u7A7A");return}if(!this.formdata.description){r.warning("\u4F5C\u54C1\u8BE6\u60C5\u4E0D\u80FD\u4E3A\u7A7A");return}if(!this.formdata.workFile){r.warning("\u8BF7\u5148\u4E0A\u4F20\u4F5C\u54C1\u6587\u4EF6");return}if(!this.ON){r.warning("\u8BF7\u52FE\u9009\u9690\u79C1\u653F\u7B56");return}S(this.formdata).then(s=>{console.log(s),s.code?(r.error(s.description+s.msg),this.pop2=!0):(r.success("\u53D1\u5E03\u6210\u529F"),this.pop1=!0)}).catch(s=>{r.error("\u51FA\u9519\u4E86"),this.pop2=!0})}},mounted(){this.isSafari=V(),T().then(s=>{s.code?r.error(s.msg):this.formdata.contestId=s.data.contestId})}},f=s=>(I("data-v-184d2946"),s=s(),B(),s),L={class:"submit"},z=f(()=>i("div",{class:"title"},"\u6295\u7A3F",-1)),A={class:"dad-upload"},D=f(()=>i("div",{class:"info"},[i("div",{class:"icon"}),i("div",{class:"t1"},"\u4E0A\u4F20\u6587\u4EF6"),i("div",{class:"t2"},w(`\u8BF7\u4FDD\u7559 EXIF \u4FE1\u606F

\u8BF7\u786E\u8BA4\u60A8\u4E0A\u4F20\u7684\u4F5C\u54C1\u7684\u8457\u4F5C\u6743\u4E3A\u672C\u4EBA\u6240\u6709\uFF0C
\u7981\u6B62\u4E0A\u4F20\u4ED6\u4EBA\u4F5C\u54C1\u3002
\u5982\u6709\u4FB5\u6743\u884C\u4E3A\uFF0C\u60A8\u5C06\u627F\u62C5\u76F8\u5E94\u7684\u6CD5\u5F8B\u8D23\u4EFB\u3002`))],-1)),H={key:0,class:"overCover"},R=["src"],U=["src"],j={key:2,class:"mask-1"},M=f(()=>i("div",{class:"loading-icon"},null,-1)),P=f(()=>i("div",{class:"loading-icon load-double"},null,-1)),X=[M,P],q={class:"tab-bar"},J={class:"tab-block-1"},K=["onClick"],Q={class:"tab tab-0"},Y=f(()=>i("p",{class:"art-name"},"\u4F5C\u54C1\u9898\u76EE",-1)),Z=f(()=>i("p",{class:"art-name"},"\u4F5C\u54C1\u4ECB\u7ECD",-1)),$={class:"dad-btn"};function ee(s,t,g,c,e,l){const n=x,h=O,a=F;return p(),m("div",L,[z,i("div",A,[i("div",{onClick:t[2]||(t[2]=(...o)=>l.upload&&l.upload(...o)),class:"upload",style:v({height:e.xheight?e.xheight+"px":""})},[D,e.source?(p(),m("div",H,[l.contestgroup==3?(p(),m("video",{key:0,ref:"videoEle",controls:!1,muted:"",class:"source-img",src:e.source,alt:""},null,8,R)):(p(),m("img",{key:1,ref:"sourceImg",class:"source-img",src:e.source,alt:""},null,8,U)),e.loading?(p(),m("div",j,X)):k("",!0),i("div",{onClick:t[1]||(t[1]=y(()=>{},["stop"])),class:"tool-box"},[i("div",{onClick:t[0]||(t[0]=(...o)=>l.trashFn&&l.trashFn(...o)),class:"trash"})])])):k("",!0)],4)]),i("div",q,[i("div",J,[(p(),m(N,null,E(["\u5355\u53CD\u7EC4","\u968F\u624B\u62CD\u7EC4","\u77ED\u89C6\u9891\u7EC4","AI \u7EC4"],(o,u)=>i("div",{onClick:te=>l.TabClick(u+1),class:_({"tab-item":1,"tab-item-active":l.contestgroup==u+1}),key:u},w(o),11,K)),64))]),i("div",{class:"desc",style:v({left:(l.contestgroup-1)*(100/4)+"%",marginLeft:`calc(50%/${4})`})},null,4)]),i("div",Q,[Y,d(n,{modelValue:e.formdata.workTitle,"onUpdate:modelValue":t[3]||(t[3]=o=>e.formdata.workTitle=o),placeholder:"\u8F93\u5165\u4F5C\u54C1\u9898\u76EE...",class:"art-name-input"},null,8,["modelValue"]),Z,d(n,{type:"textarea",maxlength:"300",autosize:{minRows:4,maxRows:20},resize:"none",modelValue:e.formdata.description,"onUpdate:modelValue":t[4]||(t[4]=o=>e.formdata.description=o),rows:5,placeholder:"\u8F93\u5165\u4F5C\u54C1\u4ECB\u7ECD...",class:"art-name-textarea"},null,8,["modelValue"])]),i("div",$,[d(h,{ON:e.ON,onCheck:t[5]||(t[5]=o=>e.ON=!e.ON)},null,8,["ON"]),i("div",{class:"sub-btn",onClick:t[6]||(t[6]=(...o)=>l.submit&&l.submit(...o))}," \u63D0\u4EA4 ")]),d(a,{ON:e.pop1,model:1,title:"\u7A3F\u4EF6\u5DF2\u63D0\u4EA4",tip:"\u7A0D\u540E\u8BF7\u5728\u4E2A\u4EBA\u4E2D\u5FC3\u67E5\u770B",options:{black:"",grey:"",blue:"\u5B8C\u6210"},onBlackClick:o=>0,onBlueClick:t[7]||(t[7]=o=>{s.$router.back(),e.pop1=!1})},null,8,["ON"]),d(a,{ON:e.pop2,model:0,title:"\u63D0\u4EA4\u4E0D\u6210\u529F",tip:"\u8BF7\u68C0\u67E5\u7F51\u7EDC\u6216\u8054\u7CFB\u7BA1\u7406\u5458",options:{black:"",grey:"",blue:"\u8FD4\u56DE"},onBlackClick:o=>0,onBlueClick:t[8]||(t[8]=o=>e.pop2=!1)},null,8,["ON"]),d(a,{ON:e.pop3,model:0,title:"\u786E\u8BA4\u8981\u5220\u9664\u4F5C\u54C1\u5417",tip:"\u8BE5\u64CD\u4F5C\u65E0\u6CD5\u88AB\u64A4\u9500\u3002",options:{black:"\u5220\u9664",grey:"",blue:"\u53D6\u6D88"},onGreyClick:o=>0,onBlueClick:t[9]||(t[9]=o=>e.pop3=!1),onBlackClick:l.removeWork},null,8,["ON","onBlackClick"]),d(a,{ON:e.pop4,model:0,title:"\u786E\u8BA4\u8981\u66F4\u6362\u4F5C\u54C1\u5417",tip:"\u8BE5\u64CD\u4F5C\u65E0\u6CD5\u88AB\u64A4\u9500\u3002",options:{black:"\u66F4\u6362",grey:"",blue:"\u53D6\u6D88"},onGreyClick:o=>0,onBlueClick:t[10]||(t[10]=o=>e.pop4=!1),onBlackClick:t[11]||(t[11]=o=>{e.pop4=!1,l.removeWork(),l.upload()})},null,8,["ON"]),d(a,{ON:e.pop5,model:0,title:"\u66F4\u6362\u7C7B\u522B\u5C06\u6E05\u7A7A\u6587\u4EF6",tip:"\u8BE5\u64CD\u4F5C\u65E0\u6CD5\u88AB\u64A4\u9500\u3002",options:{black:"\u786E\u8BA4",grey:"",blue:"\u53D6\u6D88"},onGreyClick:o=>0,onBlueClick:t[12]||(t[12]=o=>e.pop5=!1),onBlackClick:t[13]||(t[13]=o=>{e.pop5=!1,l.removeWork(),e.formdata.contestGroup=e.group_cache})},null,8,["ON"]),i("div",{class:_(e.isSafari?"footer":"")},null,2)])}var ce=C(G,[["render",ee],["__scopeId","data-v-184d2946"]]);export{ce as default};
